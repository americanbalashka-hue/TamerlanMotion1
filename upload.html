<!-- upload.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TamerlanMotion 1.0 - Загрузка AR-файлов</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Inter',sans-serif;
  background:linear-gradient(135deg,#a8e6cf,#dcedc1);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow-x:hidden;
  padding:10px;
}
.upload-container{
  background:#fff;
  padding:40px 25px;
  border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,0.2);
  width:100%;
  max-width:480px;
  transition:all 0.4s ease;
  position:relative;
  opacity:0;
  transform:translateY(30px);
  animation:fadeInUp 0.8s forwards;
}
@keyframes fadeInUp{
  to{
    opacity:1;
    transform:translateY(0);
  }
}
.upload-container:hover{
  transform:translateY(-3px);
}
h2{
  text-align:center;
  color:#166534;
  margin-bottom:25px;
  font-weight:700;
  font-size:24px;
  letter-spacing:1px;
}
#mindButton{
  display:block;
  width:100%;
  padding:16px;
  font-size:16px;
  font-weight:700;
  border:none;
  border-radius:12px;
  cursor:pointer;
  color:white;
  background:linear-gradient(90deg,#16a34a,#22c55e);
  margin-bottom:20px;
  transition:all 0.3s ease;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
}
#mindButton:hover{
  background:linear-gradient(90deg,#22c55e,#16a34a);
  transform:translateY(-2px);
}
.instruction{
  font-size:14px;
  color:#065f46;
  line-height:1.6;
  margin-bottom:20px;
}
.instruction p{
  margin:8px 0;
}
input[type="text"], input[type="file"]{
  width:100%;
  padding:14px 12px;
  margin:10px 0;
  border-radius:10px;
  border:1px solid #a7f3d0;
  font-size:15px;
  transition:all 0.3s;
}
input[type="text"]:focus,input[type="file"]:focus{
  outline:none;
  border-color:#16a34a;
  box-shadow:0 0 0 3px rgba(22,163,74,0.2);
}
button[type="submit"]{
  width:100%;
  padding:16px;
  font-size:16px;
  font-weight:700;
  border:none;
  border-radius:12px;
  background:linear-gradient(90deg,#10b981,#34d399);
  color:white;
  cursor:pointer;
  transition:all 0.3s ease;
  margin-top:12px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
}
button[type="submit"]:hover{
  background:linear-gradient(90deg,#34d399,#6ee7b7);
  transform:translateY(-2px);
}
button[type="submit"]:active{
  transform:translateY(1px);
}
#progressBar{
  display:none;
  width:100%;
  background:#d1fae5;
  border-radius:12px;
  margin-top:20px;
  height:22px;
  overflow:hidden;
  box-shadow:inset 0 2px 5px rgba(0,0,0,0.1);
}
#progressBar div{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#16a34a,#22c55e);
  text-align:center;
  color:white;
  font-size:13px;
  line-height:22px;
  transition:width 0.4s ease;
  border-radius:12px;
}
#status{
  margin-top:15px;
  text-align:center;
  font-size:14px;
  color:#065f46;
  min-height:22px;
  opacity:0;
  transition:opacity 0.5s ease;
}
.preview-container{
  margin-top:15px;
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
  opacity:0;
  transform:translateY(20px);
  transition:opacity 0.6s ease, transform 0.6s ease;
}
.preview-container.show{
  opacity:1;
  transform:translateY(0);
}
/* Превью с зелёным градиентом при наведении */
.preview-container img,
.preview-container video{
  width:90px;
  height:90px;
  object-fit:cover;
  border-radius:10px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  transition:transform 0.3s, box-shadow 0.3s, filter 0.3s, border 0.3s;
}
.preview-container img:hover,
.preview-container video:hover{
  transform:scale(1.1);
  box-shadow:0 10px 25px rgba(5,150,105,0.6);
  filter: drop-shadow(0 0 8px rgba(22,163,74,0.8));
  border:2px solid #16a34a;
}
/* Контакты Telegram */
.contact{
  margin-top:20px;
  text-align:center;
  opacity:0;
  transform:translateY(20px);
  animation:fadeInUpContact 1s forwards 1s;
}
@keyframes fadeInUpContact{
  to{
    opacity:1;
    transform:translateY(0);
  }
}
.tg-btn{
  text-decoration:none;
  color:white;
  background:linear-gradient(135deg,#059669,#10b981);
  padding:12px 18px;
  border-radius:15px;
  font-weight:700;
  font-size:16px;
  display:inline-flex;
  align-items:center;
  gap:8px;
  box-shadow:0 5px 20px rgba(5,150,105,0.4);
  transition:all 0.4s ease, box-shadow 0.4s ease;
}
.tg-btn:hover{
  transform:translateY(-5px) scale(1.05);
  box-shadow:0 10px 30px rgba(5,150,105,0.6);
  background:linear-gradient(135deg,#10b981,#059669);
}
.tg-btn svg{
  width:20px;
  height:20px;
  fill:white;
  transition: transform 0.4s ease;
}
.tg-btn:hover svg{
  transform:rotate(-10deg) scale(1.1);
}
@media(max-width:480px){
  .upload-container{
    padding:30px 20px;
  }
  h2{
    font-size:22px;
  }
  input[type="text"], input[type="file"], button[type="submit"]{
    padding:14px;
    font-size:15px;
  }
  .preview-container img,.preview-container video{
    width:80px;
    height:80px;
  }
}
</style>
</head>
<body>
<div class="upload-container">
<h2>TamerlanMotion 1.0</h2>
<button id="mindButton" onclick="window.open('https://hiukim.github.io/mind-ar-js-doc/tools/compile/','_blank')">Открыть генератор .mind</button>
<div class="instruction">
<p><strong>Шаг 1:</strong> Получите секретный код для загрузки.</p>
<p><strong>Шаг 2:</strong> Создайте .mind файл через генератор.</p>
<p><strong>Шаг 3:</strong> Скачайте файл <code>.mind</code>.</p>
<p><strong>Шаг 4:</strong> Введите секретный код и загрузите фото, видео и .mind в форму.</p>
</div>
<form id="uploadForm" enctype="multipart/form-data">
<input type="text" name="secretCode" placeholder="Введите секретный код" required>
<input type="file" name="photo" accept="image/jpeg" required>
<input type="file" name="video" accept="video/mp4" required>
<input type="file" name="mind" accept=".mind" required>
<button type="submit">Загрузить</button>
</form>
<div class="preview-container" id="previewContainer"></div>
<div id="progressBar"><div></div></div>
<div id="status"></div>

<!-- Кнопка Telegram -->
<div class="contact">
  <a href="https://t.me/tommy8873" target="_blank" class="tg-btn">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240">
      <path d="M120 0C53.7 0 0 53.7 0 120s53.7 120 120 120 120-53.7 120-120S186.3 0 120 0zm55.7 81.6l-20.3 95.8c-1.5 6.9-5.5 8.6-11.1 5.3l-30.7-22.7-14.8 14.3c-1.6 1.6-2.9 2.9-5.4 2.9l2-28.6 52-47.1c2.3-2 0.4-3.1-3.2-1.1l-64.3 40.5-27.7-8.6c-6-1.9-6.1-6-1.3-8.9l107.5-41.5c5-1.9 9.3 1.1 7.7 8.2z"/>
    </svg>
    Написать создателю
  </a>
</div>
</div>

<script>
const form=document.getElementById('uploadForm');
const progressBar=document.getElementById('progressBar');
const progress=progressBar.firstElementChild;
const status=document.getElementById('status');
const previewContainer=document.getElementById('previewContainer');
const fileInputs=form.querySelectorAll('input[type="file"]');

fileInputs.forEach(input=>{
  input.addEventListener('change',()=>{
    previewContainer.innerHTML='';
    fileInputs.forEach(fInput=>{
      if(fInput.files[0]){
        if(fInput.files[0].type.startsWith('image/')){
          const img=document.createElement('img');
          img.src=URL.createObjectURL(fInput.files[0]);
          previewContainer.appendChild(img);
        } else if(fInput.files[0].type.startsWith('video/')){
          const vid=document.createElement('video');
          vid.src=URL.createObjectURL(fInput.files[0]);
          vid.controls=true;
          previewContainer.appendChild(vid);
        }
      }
    });
    previewContainer.classList.add('show');
  });
});

form.addEventListener('submit',e=>{
  e.preventDefault();
  const files=new FormData(form);
  const xhr=new XMLHttpRequest();
  xhr.open('POST','/upload',true);
  xhr.upload.onprogress=event=>{
    if(event.lengthComputable){
      const percent=Math.round((event.loaded/event.total)*100);
      progress.style.width=percent+'%';
      progress.textContent=percent+'%';
      progressBar.style.display='block';
    }
  };
  xhr.onload=()=>{
    if(xhr.status===200){
      status.innerHTML=xhr.responseText;
      status.style.opacity=1;
      progress.style.width='100%';
      progress.textContent='Готово!';
    } else {
      status.innerHTML='<p style="color:red;">'+xhr.responseText+'</p>';
      status.style.opacity=1;
    }
  };
  xhr.send(files);
});
</script>
</body>
</html>